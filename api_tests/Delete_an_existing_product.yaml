# Test generated by RoostGPT for test credwallet-integration-artillery-updated using AI Type Open AI and AI Model gpt-4


config:
  target: "{{ $processEnvironment.API_HOST }}"
  plugins:
    expect: {}
  payload:
    path: "Delete_an_existing_product.csv"
    skipHeader: true
    fields:
      - "productId"
  phases:
    - duration: 60
      arrivalRate: 20

scenarios:
  - name: "Delete an existing product"
    flow:
      # Fetch the product using GET request
      - get:
          url: "/products/{{ productId }}"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          expect:
            - statusCode: 200 # Expecting a successful response
            - hasProperty: "id" # Expecting the product id in the response
            - equals:
                - "{{ productId }}"
                - "{{ response.body.id }}" # Validating the product id
          capture:
            - json: "$.id"
              as: "productId"

      - think: 1

      - log: "Retrieved product with ID {{ productId }} successfully."

      # Delete the product using DELETE request
      - delete:
          url: "/products/{{ productId }}"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          expect:
            - statusCode: 200 # Expecting a successful response

      - think: 1

      - log: "Deleted product with ID {{ productId }} successfully."

      # Verify if the product was deleted by sending another GET request
      - get:
          url: "/products/{{ productId }}"
          headers:
            Authorization: "Bearer {{ $processEnvironment.AUTH_TOKEN }}"
          expect:
            - statusCode: 404 # Expecting a 404 response as the product was deleted

      - think: 1

      - log: "Verified product with ID {{ productId }} no longer exists."
